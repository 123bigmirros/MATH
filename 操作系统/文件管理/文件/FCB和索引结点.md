### 基本概念  
**概念**   
- 文件  
文件是以磁盘为载体的存储在计算机上的信息集合。用户进行输入输出时，是以文件为基本单位。  
- 文件系统  
为用户提供对文件的基本操作。  
提供与二级存储相关的二级抽象。


**文件属性**  
操作系统保存的与文件相关的信息  
1. 名称
2. 类型
3. 创建者
4. 所有者
5. 位置(指向设备和设备上文件的指针)
6. 大小
7. 保护
8. 时间(创建时间、最后一次修改时间、最后一次存取时间)


**文件控制块(FCB)**  
用来存放控制文件需要的各种信息的数据结构。FCB的有序集合称为文件目录，一个FCB就是一个文件目录项。  
主要信息包括：  
    - 基本信息。  
    文件名、文件物理地址、文件逻辑结构、文件物理结构
    - 存取控制信息。  
    文件主的控制权限、一般用户的存取权限
    - 使用信息。  
    文件建立信息、上次修改信息。

**索引结点**  
在通过目录检索文件时，文件的其他信息不会用到，所以有些系统采用文件名和文件描述信息分开，描述信息单独形成一个索引结点的数据结构，称为i结点。  
在unix系统中一个目录项由文件名和指向i结点的指针构成  
- 磁盘索引结点  
指存放在磁盘上的索引结点，每个文件有唯一的磁盘索引结点，主要有以下内容  
    - 文件主标识符
    - 文件类型
    - 文件存取权限
    - 文件物理地址(13个地址项)
    - 文件长度
    - 文件链接计数
    - 文件存取时间(文件最近被进程存取的时间、最近被修改的时间及索引结点被修改的时间)
- 内存索引结点  
存放在内存中的索引结点。文件打开时，磁盘索引结点被复制到内存的索引节点中。
内存索引结点内容在硬盘索引结点的基础上增加了以下内容：  
    - 索引结点编号(用于表示索引结点)
    - 状态(表示i结点是否上锁)
    - 访问计数(有多少个进程在访问)
    - 逻辑设备号(文件所属的逻辑设备号)
    - 链接指针(分别指向空闲链表和三列队列)

**文件操作**  
  - 创建  
  创建步骤为：一为新文件分配外存空间。二为在目录中为之创建一个目录项。
  - 写文件  
  系统必须为文件维护一个写位置指针
  - 读文件  
  系统也必须为文件维护一个读位置指针。  
  读位置指针和写位置指针通常是同一个
  - 重新定位文件  
  搜索目录以找到适当的条目，并将当前文件位置指针重新定位到给定值  
  - 删除文件  
  删除过程是找到指定的文件名的目录项，释放该文件所占的存储空间，并删除目录条目 
  - 截断文件  
  允许文件属性不变，删除文件内容，将其长度置位0并释放空间  
这些基本操作可以组合起来执行其他文件操作。  

**文件打开操作**  
为避免多次重复的检索目录，多数操作系统要求在对文件进行操作前需要显式的打开。
- 操作  
open操作根据文件名检索目录，将文件控制块从外存复制到内存打开文件表的一个条目中，并将该条目的编号复制给用户。
- 补充
操作系统维护两个表。一个系统表(全局打开的文件)，一个进程表(进程自身打开的文件)。  
系统表包含文件的相关信息，进程表的条目指向系统表中的条目。  
每个进程表根据进程所打开的文件，维护进程对文件的使用信息。  
一个进程进行打开操作时，操作系统先在系统表中查找该文件是否已存在于内存中。

每个打开文件至少有下列信息  
    1. 文件指针(读写位置指针)，对单个进程是唯一的。
    2. 文件打开计数
    3. 文件磁盘位置
    4. 访问权限
