### 高速缓冲存储器
**原理**  
高速缓存是利用局部性原理，把程序中正在使用的数据存放在cache中，使cpu的大多数访存操作针对cache进行
- 时间局部性：指最近的未来要用到的信息，很可能是现在正在使用的信息
- 空间局部性：最近要用到的信息，可能与正在使用的信息在存储空间上的临近

**公式**  
- cache命中率 = 命中次数(Nc)/(命中次数(Nc)+访存总次数)
- cache-主存系统的平均访问时间 = cache命中率×cache访问时间 ＋ (1-cache命中率)×内存访问时间  
- 
**映射方式**  
把主存的地址空间映射到cache地址空间。
- 直接映射  
主存中每一块只能装入cache中唯一的位置，产生冲突时，原块无条件替换。  
实现简单，不够灵活，冲突率高
- 全相联映射  
主存中每一块都可以装入cache中的任何位置  
冲突率低，空间利用率高，命中率高。标记比较速度慢，实现成本高
- 组相联映射  
在cache分成Q个大小相等的组，组中可有多个块，组间采用直接映射，组内采用全相联映射  
成本接近直接映射，性能上接近全相联映射、

**替换算法**  
- 随机算法(RAND)： 随机确定要替换的cache块
- 先进先出算法(FIFO)：选择最早的行进行替换，实现简单
- 最近最少使用(LRU)：一句程序访问的局部性原理，选择近期内长久未访问过的cache行作为替换，计数器记录没有被选中的次数，淘汰计数器最大值
- 最不经常使用算法：一段时间内访问最少的，计数器记录被选中的次数，淘汰计数器最小值  

**写策略**  
CPU进行写操作是，若cache命中，则可能会发生内存与cache内容不一致的问题。
- 全写法  
写操作同时更新cache和下一存储器层次。能随时保持主存数据的正确性，但增加了访存次数，解决方法是增加写缓冲，但当写操作频繁发生时，依然存在上述问题。
- 回写法  
写操作仅仅被写入cache块中，只有当修改过的块被替换时才写到较低存储结构中  

cpu写未命中的方案
- 写分配法  
加载主存中的块到cache中，然后对cache块进行更新。  
利用了程序的空间局部性，缺点是每次不命中都需要从主存中读取一块。  
- 非写分配法  
只写主存，不调块到cache中。

**其他**  
- 指令cache和数据cache分离  
统一cache设计简单，但是指令预取和存取数据操作会引发冲突。分离的指令和数据cache还可以充分利用指令和数据的不同局部性来优化性能。  
- 多级cache



