### 路由协议

**内部网关协议**  
- 概念  
在一个自治系统内部使用的路由选择协议
- RIP  

    - 算法步骤  
        1. 将地址为X的相邻的路由器发来的RIP报文进行修改(下一跳路由器地址改为X,距离增加1)
        2. 对修改后的RIP报文中每个项目执行如下操作
            - 如果原来没有目的网络N，把该项目添加到路由表
            - 原来有，但是下一跳路由器地址为X时，用收到项目替换原项
            - 原来有，且下一跳路由器地址不是X，比较距离，选择距离短的那个项目
        3. 180秒没有收到相邻路由表的RIP报文，则将该相邻路由器设置为不可达路由器(将距离设置为16)
    - 优点  
    实现简单，开销小，收敛快
    - 缺点  
        - 限制网络的规模(最大距离为15)
        - 交换的是完整的路由表，开销随网络规模最大而增大
        - 网络故障时，出现慢收敛  
    - 补充
        - 是应用层协议
    
    - 内容  
        - 维护自身到目的网络的距离记录
        - 一条路径最多包含15个路由器
        - 每30秒任意两个相邻的路由器之间广播一次RIP路由
    - 特点
        - 仅和相邻的路由器交换信息
        - 交换的是当前所知的所有信息
        - 固定时间间隔

- 开放最短路径优先协议  
    - 分组类型  
        - 问候分组(发现和维护邻站可达性)
        - 数据库描述分组(向邻站给出自己链路状态数据库的摘要)  
        - 链路状态请求分组(请求更新链路状态)
        - 链路状态更新分组(洪泛法更新链路状态)
        - 链路状态确定分组(对链路更新分组的确认)
    - 算法内容  
      - 每隔10秒，相邻路由器交换一次分组
      - 在路由器开始工作时，每个路由器使用数据库描述分组与相邻路由器交换数据库中已有的摘要
      - 路由器使用链路状态请求分组，向对方请求发送自己所缺少的某些链路状态项目的详细信息。进过一系列分组交换，建立全网同步的链路数据库
      - 在运行时，只要一个路由器的链路状态发生变化，该路由器使用链路状态更新分组向全网更新链路状态。其他路由器在更新后，发送链路状态确认分组。
      - 每30分钟刷新一次数据库中的链路状态
    - 补充
      - 发送的信息是与本路由器相邻的所有路由器的链路状态
      - 是网络层协议，直接通过IP数据报传送
      - 可设置不同单位的代价
      - 有负载均衡

**BGP**  
- 概念  
不同自治系统之间交换路由信息的协议，是一种外部网关协议。  
是数据报在一个AS中尽可能的从源站传送到目的站。
- 计算过程  
    - 每个自治系统的管理员选择至少一个路由器作为自治系统的BGP发言人。
    - BGP发言人与其他自治系统的BGP发言人建立TCP连接，交换路由信息。